# PDFä¸é•¿å›¾å¯¼å‡ºåŠŸèƒ½è®¾è®¡æ–¹æ¡ˆ

## ğŸ“‹ ç›®å½•
1. [æ¦‚è¿°](#æ¦‚è¿°)
2. [åŠŸèƒ½éœ€æ±‚](#åŠŸèƒ½éœ€æ±‚)
3. [æŠ€æœ¯æ–¹æ¡ˆ](#æŠ€æœ¯æ–¹æ¡ˆ)
4. [UIè®¾è®¡](#uiè®¾è®¡)
5. [å®ç°è®¡åˆ’](#å®ç°è®¡åˆ’)
6. [æ–‡ä»¶ç»“æ„](#æ–‡ä»¶ç»“æ„)

---

## ğŸ“Œ æ¦‚è¿°

åœ¨ç°æœ‰çš„ Lyra Exporter é¡¹ç›®åŸºç¡€ä¸Šï¼Œæ–°å¢ **PDFå¯¼å‡º** å’Œ **é•¿å›¾å¯¼å‡º** åŠŸèƒ½ï¼Œå…è®¸ç”¨æˆ·é€‰æ‹©ä¸åŒçš„å¯¼å‡ºæ ¼å¼ï¼Œæ»¡è¶³ä¸åŒåœºæ™¯çš„éœ€æ±‚ã€‚

### ç°æœ‰åŠŸèƒ½
- âœ… Markdown æ ¼å¼å¯¼å‡ºï¼ˆå•æ–‡ä»¶ï¼‰
- âœ… ZIP æ‰¹é‡å¯¼å‡º
- âœ… çµæ´»çš„å¯¼å‡ºèŒƒå›´å’Œè¿‡æ»¤é€‰é¡¹

### æ–°å¢åŠŸèƒ½
- ğŸ†• **PDFå¯¼å‡º**ï¼šä¸“ä¸šæ–‡æ¡£æ ¼å¼ï¼Œé€‚åˆæ‰“å°å’Œæ­£å¼ä¼ æ’­
- ğŸ†• **é•¿å›¾å¯¼å‡º**ï¼šç¤¾äº¤åª’ä½“å‹å¥½æ ¼å¼ï¼Œé€‚åˆåˆ†äº«ä¼ æ’­

---

## ğŸ¯ åŠŸèƒ½éœ€æ±‚

### PDFå¯¼å‡ºéœ€æ±‚

#### æ ¸å¿ƒè¦æ±‚
1. **å†…å®¹å®Œæ•´æ€§**
   - âœ… æ‰€æœ‰æ¶ˆæ¯å†…å®¹ä¸è¢«æˆªæ–­
   - âœ… é•¿ä»£ç å—è‡ªåŠ¨æ¢è¡Œï¼ˆä¸æ¨ªå‘æº¢å‡ºï¼‰
   - âœ… æ”¯æŒä»£ç è¯­æ³•é«˜äº®
   - âœ… æ”¯æŒæ•°å­¦å…¬å¼æ¸²æŸ“ï¼ˆKaTeXï¼‰
   - âœ… æ”¯æŒè¡¨æ ¼ã€åˆ—è¡¨ç­‰Markdownå…ƒç´ 

2. **åˆ†é¡µåˆç†æ€§**
   - âœ… æ¶ˆæ¯ä¸åœ¨ä¸­é—´è¢«åˆ‡æ–­
   - âœ… ä»£ç å—å°½é‡ä¸è·¨é¡µï¼ˆå¯é…ç½®ï¼‰
   - âœ… è‡ªåŠ¨åˆ†é¡µï¼Œé¿å…å­¤è¡Œ
   - âœ… æ¯é¡µæ·»åŠ é¡µçœ‰/é¡µè„šï¼ˆå¯é€‰ï¼‰

3. **é€šç”¨æ ¼å¼**
   - âœ… æ ‡å‡†PDFæ ¼å¼ï¼Œä»»ä½•è®¾å¤‡å¯æ‰“å¼€
   - âœ… æ”¯æŒæ–‡æœ¬é€‰æ‹©å’Œå¤åˆ¶
   - âœ… æ–‡ä»¶å¤§å°ä¼˜åŒ–ï¼ˆå‹ç¼©å›¾ç‰‡ç­‰ï¼‰
   - âœ… æ”¯æŒä¹¦ç­¾/ç›®å½•ï¼ˆå¯é€‰ï¼‰

#### æ ·å¼è®¾è®¡
- ä¸“ä¸šç®€æ´çš„æ–‡æ¡£é£æ ¼
- ç”¨æˆ·æ¶ˆæ¯ä¸åŠ©æ‰‹æ¶ˆæ¯æœ‰æ˜æ˜¾åŒºåˆ†
- ä»£ç å—èƒŒæ™¯è‰²åŒºåˆ†
- åˆç†çš„å­—ä½“å¤§å°å’Œè¡Œè·
- é¡µçœ‰åŒ…å«å¯¹è¯æ ‡é¢˜
- é¡µè„šåŒ…å«é¡µç 

#### å¯é…ç½®é€‰é¡¹
```javascript
{
  // åŸºç¡€é€‰é¡¹
  includePageNumbers: true,      // æ˜¾ç¤ºé¡µç 
  includeHeader: true,            // æ˜¾ç¤ºé¡µçœ‰
  includeFooter: true,            // æ˜¾ç¤ºé¡µè„š
  includeTOC: false,              // ç”Ÿæˆç›®å½•ï¼ˆé•¿æ–‡æ¡£ï¼‰

  // å†…å®¹é€‰é¡¹ï¼ˆç»§æ‰¿ç°æœ‰çš„ï¼‰
  includeThinking: true,
  includeTools: true,
  includeArtifacts: true,
  includeCitations: true,
  includeTimestamps: false,

  // PDFç‰¹å®šé€‰é¡¹
  pageSize: 'A4',                 // é¡µé¢å¤§å°
  fontSize: 12,                   // åŸºç¡€å­—ä½“å¤§å°
  codeWrap: true,                 // ä»£ç è‡ªåŠ¨æ¢è¡Œ
  avoidCodePageBreak: true,       // é¿å…ä»£ç å—è·¨é¡µ
  colorScheme: 'light'            // light/dark
}
```

---

### é•¿å›¾å¯¼å‡ºéœ€æ±‚

#### æ ¸å¿ƒè¦æ±‚
1. **ç«–å‘é•¿å›¾**
   - âœ… æ‰€æœ‰æ¶ˆæ¯çºµå‘æ’åˆ—
   - âœ… è‡ªé€‚åº”é«˜åº¦ï¼ˆæ ¹æ®å†…å®¹ï¼‰
   - âœ… å›ºå®šå®½åº¦ï¼ˆé€‚åˆæ‰‹æœºæŸ¥çœ‹ï¼‰
   - âœ… é«˜è´¨é‡PNGè¾“å‡º

2. **è§†è§‰æ•ˆæœ**
   - âœ… å¯¹è¯æ°”æ³¡æ ·å¼ï¼ˆç±»ä¼¼èŠå¤©åº”ç”¨ï¼‰
   - âœ… ç”¨æˆ·æ¶ˆæ¯åœ¨å³ä¾§ï¼ˆè“è‰²æ°”æ³¡ï¼‰
   - âœ… åŠ©æ‰‹æ¶ˆæ¯åœ¨å·¦ä¾§ï¼ˆç°è‰²æ°”æ³¡ï¼‰
   - âœ… å¸¦å¤´åƒå›¾æ ‡
   - âœ… æ˜¾ç¤ºæ—¶é—´æˆ³ï¼ˆå¯é€‰ï¼‰
   - âœ… æ¸å˜èƒŒæ™¯æˆ–çº¯è‰²èƒŒæ™¯

3. **ç¤¾äº¤åª’ä½“é€‚é…**
   - âœ… é€‚åˆå¾®ä¿¡ã€å¾®åšã€Twitterç­‰å¹³å°åˆ†äº«
   - âœ… å®½åº¦å›ºå®šä¸º 750pxï¼ˆç§»åŠ¨ç«¯å‹å¥½ï¼‰
   - âœ… é«˜åº¦è‡ªé€‚åº”ï¼ˆæœ€å¤§æ”¯æŒ20000pxï¼‰
   - âœ… æ°´å°æ”¯æŒï¼ˆå¯é€‰ï¼‰

#### æ ·å¼è®¾è®¡
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    [èƒŒæ™¯ï¼šæ¸å˜/çº¯è‰²]     â”‚
â”‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  ğŸ‘¤  â”‚ â† ç”¨æˆ·æ¶ˆæ¯ï¼ˆå³å¯¹é½ï¼‰
â”‚  â”‚  ç”¨æˆ·æ¶ˆæ¯      â”‚      â”‚   è“è‰²æ°”æ³¡
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                         â”‚
â”‚  ğŸ¤–  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â† åŠ©æ‰‹æ¶ˆæ¯ï¼ˆå·¦å¯¹é½ï¼‰
â”‚      â”‚  åŠ©æ‰‹å›å¤      â”‚  â”‚   ç°è‰²æ°”æ³¡
â”‚      â”‚  - ä»£ç é«˜äº®    â”‚  â”‚
â”‚      â”‚  - å¤šè¡Œæ–‡æœ¬    â”‚  â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚
â”‚       [æ—¶é—´æˆ³]           â”‚
â”‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### å¯é…ç½®é€‰é¡¹
```javascript
{
  // åŸºç¡€é€‰é¡¹
  width: 750,                     // å›¾ç‰‡å®½åº¦ï¼ˆpxï¼‰
  backgroundColor: 'linear',      // èƒŒæ™¯ç±»å‹ï¼šsolid/linear/image
  bgColor: '#f5f5f5',            // çº¯è‰²èƒŒæ™¯
  bgGradient: ['#667eea', '#764ba2'], // æ¸å˜è‰²

  // æ°”æ³¡æ ·å¼
  bubbleStyle: 'modern',          // modern/classic/minimal
  showAvatar: true,               // æ˜¾ç¤ºå¤´åƒ
  showTimestamp: true,            // æ˜¾ç¤ºæ—¶é—´

  // å†…å®¹é€‰é¡¹ï¼ˆç»§æ‰¿ç°æœ‰çš„ï¼‰
  includeThinking: false,         // æ€è€ƒè¿‡ç¨‹é»˜è®¤å…³é—­
  includeTools: true,
  includeArtifacts: true,

  // æ°´å°
  watermark: {
    enabled: false,
    text: 'Generated by Lyra',
    position: 'bottom-right'
  }
}
```

---

## ğŸ”§ æŠ€æœ¯æ–¹æ¡ˆ

### PDFå¯¼å‡ºæŠ€æœ¯é€‰å‹

#### æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ | æ¨èåº¦ |
|------|------|------|--------|
| **@react-pdf/renderer** | âœ… Reactç»„ä»¶å¼<br>âœ… æ ·å¼å¯æ§<br>âœ… è´¨é‡é«˜<br>âœ… æ”¯æŒåˆ†é¡µæ§åˆ¶ | âŒ åŒ…ä½“ç§¯è¾ƒå¤§(~500KB)<br>âŒ å­¦ä¹ æˆæœ¬ | â­â­â­â­â­ |
| jsPDF + html2canvas | âœ… ç®€å•æ˜“ç”¨<br>âœ… å…¼å®¹æ€§å¥½ | âŒ æ–‡æœ¬æ— æ³•é€‰æ‹©<br>âŒ æ–‡ä»¶è¾ƒå¤§<br>âŒ æ¨¡ç³Š | â­â­â­ |
| pdfmake | âœ… åŠŸèƒ½å¼ºå¤§<br>âœ… é…ç½®çµæ´» | âŒ JSONé…ç½®å¤æ‚<br>âŒ ä¸ç¬¦åˆReacté£æ ¼ | â­â­â­ |
| html2pdf.js | âœ… ç›´æ¥HTMLè½¬æ¢ | âŒ åˆ†é¡µæ§åˆ¶å·®<br>âŒ å¤§æ–‡ä»¶æ€§èƒ½å·® | â­â­ |

#### æœ€ç»ˆé€‰æ‹©ï¼š**@react-pdf/renderer**

**åŸå› ï¼š**
1. å®Œå…¨ä½¿ç”¨Reactç»„ä»¶ï¼Œä¸é¡¹ç›®æŠ€æœ¯æ ˆä¸€è‡´
2. ç²¾ç¡®æ§åˆ¶åˆ†é¡µå’Œæ ·å¼
3. ç”Ÿæˆçš„PDFæ–‡æœ¬å¯é€‰æ‹©ã€å¯æœç´¢
4. æ”¯æŒè‡ªå®šä¹‰å­—ä½“ã€ä»£ç é«˜äº®
5. æ€§èƒ½ä¼˜ç§€ï¼Œé€‚åˆé•¿æ–‡æ¡£

**ä¾èµ–å®‰è£…ï¼š**
```bash
npm install @react-pdf/renderer
npm install react-syntax-highlighter-pdf  # PDFä¸­çš„ä»£ç é«˜äº®
```

**æ ¸å¿ƒä»£ç ç»“æ„ï¼š**
```javascript
// utils/pdfExportManager.js
import { Document, Page, Text, View, StyleSheet, pdf } from '@react-pdf/renderer';

class PDFGenerator {
  constructor(config) {
    this.config = config;
  }

  // ç”ŸæˆPDFæ–‡æ¡£
  generateDocument(messages) {
    return (
      <Document>
        <Page size="A4" style={styles.page}>
          <View style={styles.header}>
            <Text>å¯¹è¯æ ‡é¢˜</Text>
          </View>
          {messages.map(msg => this.renderMessage(msg))}
          <View style={styles.footer}>
            <Text render={({ pageNumber, totalPages }) =>
              `${pageNumber} / ${totalPages}`
            } fixed />
          </View>
        </Page>
      </Document>
    );
  }

  // æ¸²æŸ“å•æ¡æ¶ˆæ¯
  renderMessage(message) {
    return (
      <View style={styles.message} wrap={false}>
        <Text style={styles.sender}>{message.sender}</Text>
        <Text>{message.content}</Text>
        {message.code && this.renderCode(message.code)}
      </View>
    );
  }

  // å¯¼å‡ºä¸ºæ–‡ä»¶
  async export(messages, filename) {
    const doc = this.generateDocument(messages);
    const blob = await pdf(doc).toBlob();
    saveAs(blob, filename);
  }
}
```

---

### é•¿å›¾å¯¼å‡ºæŠ€æœ¯é€‰å‹

#### æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ | æ¨èåº¦ |
|------|------|------|--------|
| **html2canvas** | âœ… æˆç†Ÿç¨³å®š<br>âœ… CSSæ”¯æŒå¥½<br>âœ… é•¿é¡µé¢æ”¯æŒ | âŒ æŸäº›CSSç‰¹æ€§ä¸æ”¯æŒ<br>âŒ æ€§èƒ½ä¸€èˆ¬ | â­â­â­â­â­ |
| dom-to-image | âœ… SVGè¾“å‡ºæ¸…æ™° | âŒ å·²åœæ­¢ç»´æŠ¤<br>âŒ é•¿é¡µé¢æœ‰é—®é¢˜ | â­â­ |
| modern-screenshot | âœ… æ›´å¿«<br>âœ… æ›´æ¸…æ™° | âŒ è¾ƒæ–°ï¼Œç¨³å®šæ€§å¾…éªŒè¯ | â­â­â­â­ |

#### æœ€ç»ˆé€‰æ‹©ï¼š**html2canvas**

**åŸå› ï¼š**
1. æœ€æˆç†Ÿç¨³å®šï¼Œç¤¾åŒºæ´»è·ƒ
2. æ”¯æŒé•¿é¡µé¢æˆªå›¾ï¼ˆ>10000pxï¼‰
3. å¯¹å¤æ‚CSSæ ·å¼æ”¯æŒå¥½
4. æœ‰å¤§é‡å®è·µæ¡ˆä¾‹

**ä¾èµ–å®‰è£…ï¼š**
```bash
npm install html2canvas
```

**æ ¸å¿ƒä»£ç ç»“æ„ï¼š**
```javascript
// utils/imageExportManager.js
import html2canvas from 'html2canvas';

class ImageGenerator {
  constructor(config) {
    this.config = config;
  }

  // åˆ›å»ºéšè—å®¹å™¨
  createContainer(messages) {
    const container = document.createElement('div');
    container.style.cssText = `
      position: fixed;
      left: -9999px;
      width: ${this.config.width}px;
      background: ${this.config.bgColor};
    `;

    // æ¸²æŸ“èŠå¤©æ°”æ³¡
    ReactDOM.render(
      <ChatBubbleContainer
        messages={messages}
        config={this.config}
      />,
      container
    );

    document.body.appendChild(container);
    return container;
  }

  // å¯¼å‡ºä¸ºå›¾ç‰‡
  async export(messages, filename) {
    const container = this.createContainer(messages);

    // ç­‰å¾…æ¸²æŸ“å®Œæˆ
    await new Promise(resolve => setTimeout(resolve, 100));

    // æˆªå›¾
    const canvas = await html2canvas(container, {
      scale: 2,           // 2å€åˆ†è¾¨ç‡ï¼Œæ›´æ¸…æ™°
      useCORS: true,      // æ”¯æŒè·¨åŸŸå›¾ç‰‡
      logging: false,
      windowHeight: container.scrollHeight
    });

    // ä¸‹è½½
    canvas.toBlob(blob => {
      saveAs(blob, filename);
      document.body.removeChild(container);
    });
  }
}
```

**èŠå¤©æ°”æ³¡ç»„ä»¶ï¼š**
```javascript
// components/ChatBubbleContainer.js
const ChatBubbleContainer = ({ messages, config }) => {
  return (
    <div className="chat-container" style={containerStyles}>
      {messages.map((msg, idx) => (
        <ChatBubble
          key={idx}
          message={msg}
          isUser={msg.sender === 'user'}
          config={config}
        />
      ))}
    </div>
  );
};

const ChatBubble = ({ message, isUser, config }) => {
  return (
    <div className={`bubble ${isUser ? 'user' : 'assistant'}`}>
      {config.showAvatar && (
        <div className="avatar">
          {isUser ? 'ğŸ‘¤' : 'ğŸ¤–'}
        </div>
      )}
      <div className="bubble-content">
        <div className="bubble-text">
          {message.content}
        </div>
        {config.showTimestamp && (
          <div className="timestamp">
            {message.timestamp}
          </div>
        )}
      </div>
    </div>
  );
};
```

---

## ğŸ¨ UIè®¾è®¡

### å¯¼å‡ºé¢æ¿æ”¹é€ 

åœ¨ç°æœ‰ `ExportPanel.js` çš„åŸºç¡€ä¸Šæ·»åŠ æ ¼å¼é€‰æ‹©ï¼š

```javascript
// åœ¨ exportOptions ä¸­æ·»åŠ  format å­—æ®µ
const [exportOptions, setExportOptions] = useState({
  format: 'markdown',  // æ–°å¢ï¼šmarkdown | pdf | image
  scope: 'current',
  // ... å…¶ä»–ç°æœ‰é€‰é¡¹

  // PDFç‰¹å®šé€‰é¡¹
  pdf: {
    includePageNumbers: true,
    includeHeader: true,
    includeTOC: false,
    pageSize: 'A4',
    fontSize: 12
  },

  // é•¿å›¾ç‰¹å®šé€‰é¡¹
  image: {
    width: 750,
    backgroundColor: 'linear',
    bubbleStyle: 'modern',
    showAvatar: true,
    showTimestamp: true
  }
});
```

### é¢æ¿å¸ƒå±€ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¯¼å‡ºè®¾ç½®                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  ğŸ“„ å¯¼å‡ºæ ¼å¼                          â”‚
â”‚  â—‹ Markdown  â—‹ PDF  â—‹ é•¿å›¾           â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  ğŸ“ å¯¼å‡ºèŒƒå›´ï¼ˆç°æœ‰ï¼‰                   â”‚
â”‚  â—‹ å½“å‰å¯¹è¯                          â”‚
â”‚  â—‹ å½“å‰åˆ†æ”¯                          â”‚
â”‚  â—‹ å·²æ ‡è®°çš„å¯¹è¯                       â”‚
â”‚  â—‹ å…¨éƒ¨å¯¹è¯                          â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  ğŸ” è¿‡æ»¤å™¨ï¼ˆç°æœ‰ï¼‰                     â”‚
â”‚  â˜‘ æ’é™¤å·²åˆ é™¤                        â”‚
â”‚  â˜ åªåŒ…å«å·²å®Œæˆ                       â”‚
â”‚  â˜ åªåŒ…å«é‡è¦çš„                       â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  âš™ï¸ æ ¼å¼ä¸“å±é€‰é¡¹ï¼ˆåŠ¨æ€æ˜¾ç¤ºï¼‰            â”‚
â”‚                                     â”‚
â”‚  [å½“é€‰æ‹© PDF æ—¶]                      â”‚
â”‚  â˜‘ æ˜¾ç¤ºé¡µç                           â”‚
â”‚  â˜‘ æ˜¾ç¤ºé¡µçœ‰                          â”‚
â”‚  â˜ ç”Ÿæˆç›®å½•                          â”‚
â”‚  é¡µé¢å¤§å°: [A4 â–¼]                     â”‚
â”‚                                     â”‚
â”‚  [å½“é€‰æ‹©é•¿å›¾æ—¶]                       â”‚
â”‚  æ°”æ³¡æ ·å¼: [ç°ä»£é£æ ¼ â–¼]                â”‚
â”‚  â˜‘ æ˜¾ç¤ºå¤´åƒ                          â”‚
â”‚  â˜‘ æ˜¾ç¤ºæ—¶é—´æˆ³                        â”‚
â”‚  èƒŒæ™¯: [æ¸å˜è‰² â–¼]                     â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  ğŸ“Š å¯¼å‡ºç»Ÿè®¡ï¼ˆç°æœ‰ï¼‰                   â”‚
â”‚  å…± 10 ä¸ªæ–‡ä»¶ï¼Œ15 æ®µå¯¹è¯ï¼Œ234 æ¡æ¶ˆæ¯   â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  [å–æ¶ˆ]            [å¯¼å‡º â–¼]          â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å¯¼å‡ºæŒ‰é’®åŠ¨æ€æ–‡æœ¬

```javascript
const getExportButtonText = () => {
  switch (exportOptions.format) {
    case 'markdown':
      return t('app.export.exportToMarkdown');
    case 'pdf':
      return t('app.export.exportToPDF');
    case 'image':
      return t('app.export.exportToImage');
    default:
      return t('app.export.export');
  }
};
```

---

## ğŸ“… å®ç°è®¡åˆ’

### Phase 1: åŸºç¡€æ¶æ„ï¼ˆç¬¬1-2å¤©ï¼‰

#### 1.1 å®‰è£…ä¾èµ–
```bash
npm install @react-pdf/renderer html2canvas
```

#### 1.2 åˆ›å»ºæ–‡ä»¶ç»“æ„
```
src/
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ exportManager.js         # ç°æœ‰ï¼Œéœ€æ‰©å±•
â”‚   â”œâ”€â”€ pdfExportManager.js      # æ–°å¢ï¼šPDFå¯¼å‡º
â”‚   â””â”€â”€ imageExportManager.js    # æ–°å¢ï¼šé•¿å›¾å¯¼å‡º
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ExportPanel.js           # ç°æœ‰ï¼Œéœ€æ”¹é€ 
â”‚   â”œâ”€â”€ pdf/
â”‚   â”‚   â”œâ”€â”€ PDFDocument.js       # PDFæ–‡æ¡£ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ PDFMessage.js        # PDFæ¶ˆæ¯ç»„ä»¶
â”‚   â”‚   â””â”€â”€ PDFStyles.js         # PDFæ ·å¼
â”‚   â””â”€â”€ image/
â”‚       â”œâ”€â”€ ChatBubbleContainer.js  # æ°”æ³¡å®¹å™¨
â”‚       â””â”€â”€ ChatBubble.js        # å•ä¸ªæ°”æ³¡
â””â”€â”€ styles/
    â””â”€â”€ chat-bubble.css          # æ°”æ³¡æ ·å¼
```

#### 1.3 ä¿®æ”¹å¯¼å‡ºé¢æ¿
- [ ] æ·»åŠ æ ¼å¼é€‰æ‹©ï¼ˆå•é€‰æŒ‰é’®ç»„ï¼‰
- [ ] æ·»åŠ PDFä¸“å±é€‰é¡¹åŒºåŸŸ
- [ ] æ·»åŠ é•¿å›¾ä¸“å±é€‰é¡¹åŒºåŸŸ
- [ ] åŠ¨æ€æ˜¾ç¤º/éšè—é€‰é¡¹
- [ ] ä¿®æ”¹å¯¼å‡ºæŒ‰é’®æ–‡æœ¬

---

### Phase 2: PDFå¯¼å‡ºåŠŸèƒ½ï¼ˆç¬¬3-5å¤©ï¼‰

#### 2.1 åˆ›å»ºPDFç»„ä»¶
```javascript
// components/pdf/PDFDocument.js
import { Document, Page, Text, View, StyleSheet } from '@react-pdf/renderer';

export const PDFDocument = ({ messages, config, metadata }) => {
  return (
    <Document>
      {/* å°é¢é¡µï¼ˆå¯é€‰ï¼‰ */}
      {config.includeCover && (
        <Page size="A4" style={styles.cover}>
          <Text style={styles.title}>{metadata.title}</Text>
          <Text style={styles.date}>{metadata.date}</Text>
        </Page>
      )}

      {/* ç›®å½•ï¼ˆå¯é€‰ï¼‰ */}
      {config.includeTOC && (
        <Page size="A4" style={styles.toc}>
          <Text style={styles.tocTitle}>ç›®å½•</Text>
          {/* TOCå†…å®¹ */}
        </Page>
      )}

      {/* æ¶ˆæ¯å†…å®¹ */}
      <Page size="A4" style={styles.page}>
        {/* é¡µçœ‰ */}
        {config.includeHeader && (
          <View style={styles.header} fixed>
            <Text>{metadata.title}</Text>
          </View>
        )}

        {/* æ¶ˆæ¯åˆ—è¡¨ */}
        {messages.map((msg, idx) => (
          <PDFMessage key={idx} message={msg} config={config} />
        ))}

        {/* é¡µè„š */}
        {config.includeFooter && (
          <View style={styles.footer} fixed>
            <Text render={({ pageNumber, totalPages }) =>
              `${pageNumber} / ${totalPages}`
            } />
          </View>
        )}
      </Page>
    </Document>
  );
};
```

#### 2.2 åˆ›å»ºPDFæ¶ˆæ¯ç»„ä»¶
```javascript
// components/pdf/PDFMessage.js
export const PDFMessage = ({ message, config }) => {
  return (
    <View style={styles.message} wrap={false}>
      {/* å‘é€è€… */}
      <Text style={[
        styles.sender,
        message.sender === 'user' ? styles.userSender : styles.assistantSender
      ]}>
        {message.sender === 'user' ? 'ğŸ‘¤ ç”¨æˆ·' : 'ğŸ¤– åŠ©æ‰‹'}
      </Text>

      {/* æ¶ˆæ¯å†…å®¹ */}
      <View style={styles.content}>
        <Text>{message.content}</Text>
      </View>

      {/* ä»£ç å— */}
      {message.code && (
        <View style={styles.codeBlock}>
          <Text style={styles.codeLanguage}>{message.code.language}</Text>
          <Text style={styles.codeContent}>{message.code.content}</Text>
        </View>
      )}

      {/* æ—¶é—´æˆ³ */}
      {config.includeTimestamps && (
        <Text style={styles.timestamp}>{message.timestamp}</Text>
      )}
    </View>
  );
};
```

#### 2.3 åˆ›å»ºPDFå¯¼å‡ºç®¡ç†å™¨
```javascript
// utils/pdfExportManager.js
import { pdf } from '@react-pdf/renderer';
import { saveAs } from 'file-saver';
import { PDFDocument } from '../components/pdf/PDFDocument';

export class PDFExportManager {
  constructor(config = {}) {
    this.config = {
      includePageNumbers: true,
      includeHeader: true,
      includeFooter: true,
      includeTOC: false,
      pageSize: 'A4',
      fontSize: 12,
      ...config
    };
  }

  /**
   * å¯¼å‡ºä¸ºPDF
   */
  async export(messages, metadata) {
    try {
      // ç”ŸæˆPDFæ–‡æ¡£
      const doc = (
        <PDFDocument
          messages={messages}
          config={this.config}
          metadata={metadata}
        />
      );

      // è½¬ä¸ºBlob
      const blob = await pdf(doc).toBlob();

      // ä¸‹è½½
      const filename = `${metadata.title || 'conversation'}.pdf`;
      saveAs(blob, filename);

      return { success: true };
    } catch (error) {
      console.error('PDFå¯¼å‡ºå¤±è´¥:', error);
      return { success: false, error };
    }
  }
}
```

#### 2.4 æµ‹è¯•æ¸…å•
- [ ] çŸ­å¯¹è¯å¯¼å‡º
- [ ] é•¿å¯¹è¯å¯¼å‡ºï¼ˆå¤šé¡µï¼‰
- [ ] å«ä»£ç å—çš„å¯¹è¯
- [ ] å«æ•°å­¦å…¬å¼çš„å¯¹è¯
- [ ] åˆ†é¡µæ˜¯å¦åˆç†
- [ ] é¡µçœ‰é¡µè„šæ˜¾ç¤º
- [ ] é¡µç æ­£ç¡®æ€§
- [ ] æ–‡æœ¬å¯é€‰æ‹©æ€§

---

### Phase 3: é•¿å›¾å¯¼å‡ºåŠŸèƒ½ï¼ˆç¬¬6-8å¤©ï¼‰

#### 3.1 åˆ›å»ºèŠå¤©æ°”æ³¡ç»„ä»¶
```javascript
// components/image/ChatBubbleContainer.js
import React from 'react';
import ChatBubble from './ChatBubble';
import '../../styles/chat-bubble.css';

export const ChatBubbleContainer = ({ messages, config }) => {
  const containerStyle = {
    width: `${config.width}px`,
    background: config.backgroundColor === 'linear'
      ? `linear-gradient(135deg, ${config.bgGradient[0]}, ${config.bgGradient[1]})`
      : config.bgColor,
    padding: '40px 20px',
    fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'
  };

  return (
    <div className="chat-bubble-container" style={containerStyle}>
      {/* æ ‡é¢˜ */}
      <div className="chat-header">
        <h2>{config.title}</h2>
        <p className="chat-date">{config.date}</p>
      </div>

      {/* æ¶ˆæ¯åˆ—è¡¨ */}
      {messages.map((msg, idx) => (
        <ChatBubble
          key={idx}
          message={msg}
          isUser={msg.sender === 'user'}
          config={config}
        />
      ))}

      {/* æ°´å° */}
      {config.watermark?.enabled && (
        <div className="watermark">
          {config.watermark.text}
        </div>
      )}
    </div>
  );
};
```

#### 3.2 åˆ›å»ºæ°”æ³¡ç»„ä»¶
```javascript
// components/image/ChatBubble.js
export const ChatBubble = ({ message, isUser, config }) => {
  return (
    <div className={`chat-bubble-wrapper ${isUser ? 'user' : 'assistant'}`}>
      {/* å¤´åƒ */}
      {config.showAvatar && (
        <div className="avatar">
          {isUser ? 'ğŸ‘¤' : 'ğŸ¤–'}
        </div>
      )}

      {/* æ°”æ³¡å†…å®¹ */}
      <div className={`bubble ${config.bubbleStyle}`}>
        {/* æ¶ˆæ¯æ–‡æœ¬ */}
        <div className="bubble-text">
          {message.content}
        </div>

        {/* ä»£ç å— */}
        {message.code && (
          <div className="bubble-code">
            <div className="code-header">
              <span>{message.code.language}</span>
            </div>
            <pre><code>{message.code.content}</code></pre>
          </div>
        )}

        {/* æ—¶é—´æˆ³ */}
        {config.showTimestamp && (
          <div className="bubble-timestamp">
            {message.timestamp}
          </div>
        )}
      </div>
    </div>
  );
};
```

#### 3.3 åˆ›å»ºæ ·å¼æ–‡ä»¶
```css
/* styles/chat-bubble.css */
.chat-bubble-container {
  min-height: 100vh;
  box-sizing: border-box;
}

.chat-header {
  text-align: center;
  margin-bottom: 40px;
  color: white;
}

.chat-header h2 {
  font-size: 28px;
  margin: 0 0 10px 0;
}

.chat-date {
  font-size: 14px;
  opacity: 0.8;
}

/* æ°”æ³¡å®¹å™¨ */
.chat-bubble-wrapper {
  display: flex;
  margin: 20px 0;
  gap: 12px;
}

.chat-bubble-wrapper.user {
  flex-direction: row-reverse;
}

/* å¤´åƒ */
.avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 24px;
  flex-shrink: 0;
}

/* æ°”æ³¡ */
.bubble {
  max-width: 70%;
  padding: 16px 20px;
  border-radius: 20px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.user .bubble {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border-bottom-right-radius: 4px;
}

.assistant .bubble {
  background: white;
  color: #333;
  border-bottom-left-radius: 4px;
}

/* æ°”æ³¡æ ·å¼å˜ä½“ */
.bubble.modern {
  /* å·²å®šä¹‰ */
}

.bubble.classic {
  border-radius: 8px;
}

.bubble.minimal {
  box-shadow: none;
  border: 1px solid rgba(0,0,0,0.1);
}

/* æ–‡æœ¬ */
.bubble-text {
  font-size: 16px;
  line-height: 1.6;
  white-space: pre-wrap;
  word-break: break-word;
}

/* ä»£ç å— */
.bubble-code {
  margin-top: 12px;
  background: rgba(0,0,0,0.05);
  border-radius: 8px;
  overflow: hidden;
}

.user .bubble-code {
  background: rgba(255,255,255,0.1);
}

.code-header {
  padding: 8px 12px;
  background: rgba(0,0,0,0.1);
  font-size: 12px;
  font-weight: 600;
}

.bubble-code pre {
  margin: 0;
  padding: 12px;
  overflow-x: auto;
}

.bubble-code code {
  font-family: 'Monaco', 'Menlo', monospace;
  font-size: 14px;
}

/* æ—¶é—´æˆ³ */
.bubble-timestamp {
  margin-top: 8px;
  font-size: 12px;
  opacity: 0.6;
  text-align: right;
}

/* æ°´å° */
.watermark {
  text-align: center;
  margin-top: 40px;
  padding: 20px;
  font-size: 14px;
  opacity: 0.5;
  color: white;
}
```

#### 3.4 åˆ›å»ºé•¿å›¾å¯¼å‡ºç®¡ç†å™¨
```javascript
// utils/imageExportManager.js
import html2canvas from 'html2canvas';
import { saveAs } from 'file-saver';
import ReactDOM from 'react-dom';
import { ChatBubbleContainer } from '../components/image/ChatBubbleContainer';

export class ImageExportManager {
  constructor(config = {}) {
    this.config = {
      width: 750,
      backgroundColor: 'linear',
      bgColor: '#f5f5f5',
      bgGradient: ['#667eea', '#764ba2'],
      bubbleStyle: 'modern',
      showAvatar: true,
      showTimestamp: true,
      watermark: {
        enabled: false,
        text: 'Generated by Lyra',
        position: 'bottom-right'
      },
      ...config
    };
  }

  /**
   * åˆ›å»ºéšè—çš„æ¸²æŸ“å®¹å™¨
   */
  createRenderContainer(messages, metadata) {
    const container = document.createElement('div');
    container.id = 'temp-export-container';
    container.style.cssText = `
      position: fixed;
      left: -9999px;
      top: 0;
    `;

    document.body.appendChild(container);

    // æ¸²æŸ“Reactç»„ä»¶
    ReactDOM.render(
      React.createElement(ChatBubbleContainer, {
        messages,
        config: {
          ...this.config,
          title: metadata.title,
          date: metadata.date
        }
      }),
      container
    );

    return container;
  }

  /**
   * å¯¼å‡ºä¸ºé•¿å›¾
   */
  async export(messages, metadata) {
    let container = null;

    try {
      // åˆ›å»ºæ¸²æŸ“å®¹å™¨
      container = this.createRenderContainer(messages, metadata);

      // ç­‰å¾…æ¸²æŸ“å®Œæˆ
      await new Promise(resolve => setTimeout(resolve, 300));

      // æˆªå›¾
      const canvas = await html2canvas(container.firstChild, {
        scale: 2,                    // 2å€åˆ†è¾¨ç‡
        useCORS: true,               // æ”¯æŒè·¨åŸŸå›¾ç‰‡
        logging: false,
        allowTaint: true,
        backgroundColor: null,
        windowHeight: container.firstChild.scrollHeight,
        height: container.firstChild.scrollHeight
      });

      // è½¬ä¸ºBlobå¹¶ä¸‹è½½
      return new Promise((resolve) => {
        canvas.toBlob((blob) => {
          const filename = `${metadata.title || 'conversation'}.png`;
          saveAs(blob, filename);
          resolve({ success: true });
        }, 'image/png');
      });

    } catch (error) {
      console.error('é•¿å›¾å¯¼å‡ºå¤±è´¥:', error);
      return { success: false, error };
    } finally {
      // æ¸…ç†å®¹å™¨
      if (container && container.parentNode) {
        ReactDOM.unmountComponentAtNode(container);
        container.parentNode.removeChild(container);
      }
    }
  }
}
```

#### 3.5 æµ‹è¯•æ¸…å•
- [ ] çŸ­å¯¹è¯å¯¼å‡º
- [ ] é•¿å¯¹è¯å¯¼å‡ºï¼ˆ>10æ¡æ¶ˆæ¯ï¼‰
- [ ] è¶…é•¿å¯¹è¯ï¼ˆ>50æ¡æ¶ˆæ¯ï¼‰
- [ ] å›¾ç‰‡æ¸…æ™°åº¦
- [ ] æ°”æ³¡æ ·å¼æ­£ç¡®æ€§
- [ ] ä¸åŒèƒŒæ™¯æ•ˆæœ
- [ ] æ°´å°æ˜¾ç¤º
- [ ] ç§»åŠ¨ç«¯é¢„è§ˆæ•ˆæœ

---

### Phase 4: é›†æˆåˆ°å¯¼å‡ºé¢æ¿ï¼ˆç¬¬9-10å¤©ï¼‰

#### 4.1 ä¿®æ”¹ExportPanelç»„ä»¶

```javascript
// components/ExportPanel.js æ”¹é€ 

// 1. æ·»åŠ æ ¼å¼é€‰æ‹©åŒºåŸŸï¼ˆåœ¨scopeä¹‹å‰ï¼‰
<div className="option-group">
  <h3>{t('app.export.format.title')}</h3>
  <div className="format-options">
    <label className="radio-option format-option">
      <input
        type="radio"
        name="format"
        value="markdown"
        checked={exportOptions.format === 'markdown'}
        onChange={(e) => setExportOptions({...exportOptions, format: e.target.value})}
      />
      <div className="option-label">
        <span>ğŸ“ Markdown</span>
        <span className="option-description">
          {t('app.export.format.markdownDesc')}
        </span>
      </div>
    </label>

    <label className="radio-option format-option">
      <input
        type="radio"
        name="format"
        value="pdf"
        checked={exportOptions.format === 'pdf'}
        onChange={(e) => setExportOptions({...exportOptions, format: e.target.value})}
      />
      <div className="option-label">
        <span>ğŸ“„ PDF</span>
        <span className="option-description">
          {t('app.export.format.pdfDesc')}
        </span>
      </div>
    </label>

    <label className="radio-option format-option">
      <input
        type="radio"
        name="format"
        value="image"
        checked={exportOptions.format === 'image'}
        onChange={(e) => setExportOptions({...exportOptions, format: e.target.value})}
      />
      <div className="option-label">
        <span>ğŸ–¼ï¸ é•¿å›¾</span>
        <span className="option-description">
          {t('app.export.format.imageDesc')}
        </span>
      </div>
    </label>
  </div>
</div>

// 2. æ·»åŠ PDFä¸“å±é€‰é¡¹ï¼ˆæ¡ä»¶æ¸²æŸ“ï¼‰
{exportOptions.format === 'pdf' && (
  <div className="option-group">
    <h3>{t('app.export.pdfOptions.title')}</h3>

    <label className="checkbox-option">
      <input
        type="checkbox"
        checked={exportOptions.pdf.includePageNumbers}
        onChange={(e) => setExportOptions({
          ...exportOptions,
          pdf: {...exportOptions.pdf, includePageNumbers: e.target.checked}
        })}
      />
      <span>{t('app.export.pdfOptions.pageNumbers')}</span>
    </label>

    <label className="checkbox-option">
      <input
        type="checkbox"
        checked={exportOptions.pdf.includeHeader}
        onChange={(e) => setExportOptions({
          ...exportOptions,
          pdf: {...exportOptions.pdf, includeHeader: e.target.checked}
        })}
      />
      <span>{t('app.export.pdfOptions.header')}</span>
    </label>

    <label className="checkbox-option">
      <input
        type="checkbox"
        checked={exportOptions.pdf.includeTOC}
        onChange={(e) => setExportOptions({
          ...exportOptions,
          pdf: {...exportOptions.pdf, includeTOC: e.target.checked}
        })}
      />
      <span>{t('app.export.pdfOptions.toc')}</span>
    </label>

    <div className="select-option">
      <label>{t('app.export.pdfOptions.pageSize')}</label>
      <select
        value={exportOptions.pdf.pageSize}
        onChange={(e) => setExportOptions({
          ...exportOptions,
          pdf: {...exportOptions.pdf, pageSize: e.target.value}
        })}
      >
        <option value="A4">A4</option>
        <option value="Letter">Letter</option>
        <option value="Legal">Legal</option>
      </select>
    </div>
  </div>
)}

// 3. æ·»åŠ é•¿å›¾ä¸“å±é€‰é¡¹ï¼ˆæ¡ä»¶æ¸²æŸ“ï¼‰
{exportOptions.format === 'image' && (
  <div className="option-group">
    <h3>{t('app.export.imageOptions.title')}</h3>

    <div className="select-option">
      <label>{t('app.export.imageOptions.bubbleStyle')}</label>
      <select
        value={exportOptions.image.bubbleStyle}
        onChange={(e) => setExportOptions({
          ...exportOptions,
          image: {...exportOptions.image, bubbleStyle: e.target.value}
        })}
      >
        <option value="modern">{t('app.export.imageOptions.styleModern')}</option>
        <option value="classic">{t('app.export.imageOptions.styleClassic')}</option>
        <option value="minimal">{t('app.export.imageOptions.styleMinimal')}</option>
      </select>
    </div>

    <label className="checkbox-option">
      <input
        type="checkbox"
        checked={exportOptions.image.showAvatar}
        onChange={(e) => setExportOptions({
          ...exportOptions,
          image: {...exportOptions.image, showAvatar: e.target.checked}
        })}
      />
      <span>{t('app.export.imageOptions.showAvatar')}</span>
    </label>

    <label className="checkbox-option">
      <input
        type="checkbox"
        checked={exportOptions.image.showTimestamp}
        onChange={(e) => setExportOptions({
          ...exportOptions,
          image: {...exportOptions.image, showTimestamp: e.target.checked}
        })}
      />
      <span>{t('app.export.imageOptions.showTimestamp')}</span>
    </label>

    <div className="select-option">
      <label>{t('app.export.imageOptions.background')}</label>
      <select
        value={exportOptions.image.backgroundColor}
        onChange={(e) => setExportOptions({
          ...exportOptions,
          image: {...exportOptions.image, backgroundColor: e.target.value}
        })}
      >
        <option value="linear">{t('app.export.imageOptions.bgGradient')}</option>
        <option value="solid">{t('app.export.imageOptions.bgSolid')}</option>
      </select>
    </div>
  </div>
)}
```

#### 4.2 ä¿®æ”¹App.jså¯¼å‡ºé€»è¾‘

```javascript
// App.js

// 1. å¯¼å…¥æ–°çš„å¯¼å‡ºç®¡ç†å™¨
import { PDFExportManager } from './utils/pdfExportManager';
import { ImageExportManager } from './utils/imageExportManager';

// 2. ä¿®æ”¹å¯¼å‡ºå‡½æ•°
const handleExportClick = async () => {
  try {
    // è·å–è¦å¯¼å‡ºçš„æ¶ˆæ¯æ•°æ®
    const messages = getMessagesToExport(); // ç°æœ‰é€»è¾‘
    const metadata = getExportMetadata();    // ç°æœ‰é€»è¾‘

    // æ ¹æ®æ ¼å¼é€‰æ‹©å¯¼å‡ºæ–¹å¼
    switch (exportOptions.format) {
      case 'markdown':
        // ç°æœ‰çš„Markdownå¯¼å‡ºé€»è¾‘
        await handleExportMarkdown(messages, metadata);
        break;

      case 'pdf':
        // æ–°å¢ï¼šPDFå¯¼å‡º
        const pdfManager = new PDFExportManager(exportOptions.pdf);
        await pdfManager.export(messages, metadata);
        break;

      case 'image':
        // æ–°å¢ï¼šé•¿å›¾å¯¼å‡º
        const imageManager = new ImageExportManager(exportOptions.image);
        await imageManager.export(messages, metadata);
        break;

      default:
        console.error('æœªçŸ¥çš„å¯¼å‡ºæ ¼å¼');
    }

    // å…³é—­é¢æ¿
    setIsExportPanelOpen(false);

  } catch (error) {
    console.error('å¯¼å‡ºå¤±è´¥:', error);
    alert(t('app.export.error'));
  }
};
```

#### 4.3 æ·»åŠ å›½é™…åŒ–æ–‡æœ¬

```javascript
// locales/zh.json æ·»åŠ 
{
  "app": {
    "export": {
      // æ ¼å¼é€‰æ‹©
      "format": {
        "title": "å¯¼å‡ºæ ¼å¼",
        "markdownDesc": "çº¯æ–‡æœ¬æ ¼å¼ï¼Œé€‚åˆç¼–è¾‘å’Œç‰ˆæœ¬æ§åˆ¶",
        "pdfDesc": "ä¸“ä¸šæ–‡æ¡£æ ¼å¼ï¼Œé€‚åˆæ‰“å°å’Œæ­£å¼ä¼ æ’­",
        "imageDesc": "ç¤¾äº¤åª’ä½“å‹å¥½æ ¼å¼ï¼Œé€‚åˆåˆ†äº«ä¼ æ’­"
      },

      // PDFé€‰é¡¹
      "pdfOptions": {
        "title": "PDFé€‰é¡¹",
        "pageNumbers": "æ˜¾ç¤ºé¡µç ",
        "header": "æ˜¾ç¤ºé¡µçœ‰",
        "toc": "ç”Ÿæˆç›®å½•",
        "pageSize": "é¡µé¢å¤§å°"
      },

      // é•¿å›¾é€‰é¡¹
      "imageOptions": {
        "title": "é•¿å›¾é€‰é¡¹",
        "bubbleStyle": "æ°”æ³¡æ ·å¼",
        "styleModern": "ç°ä»£é£æ ¼",
        "styleClassic": "ç»å…¸é£æ ¼",
        "styleMinimal": "ç®€çº¦é£æ ¼",
        "showAvatar": "æ˜¾ç¤ºå¤´åƒ",
        "showTimestamp": "æ˜¾ç¤ºæ—¶é—´æˆ³",
        "background": "èƒŒæ™¯",
        "bgGradient": "æ¸å˜è‰²",
        "bgSolid": "çº¯è‰²"
      },

      // æŒ‰é’®æ–‡æœ¬
      "exportToMarkdown": "å¯¼å‡ºä¸º Markdown",
      "exportToPDF": "å¯¼å‡ºä¸º PDF",
      "exportToImage": "å¯¼å‡ºä¸ºé•¿å›¾",
      "error": "å¯¼å‡ºå¤±è´¥ï¼Œè¯·é‡è¯•"
    }
  }
}
```

#### 4.4 æµ‹è¯•æ¸…å•
- [ ] æ ¼å¼åˆ‡æ¢åŠŸèƒ½
- [ ] ä¸“å±é€‰é¡¹æ˜¾ç¤º/éšè—
- [ ] å¯¼å‡ºæŒ‰é’®æ–‡æœ¬åˆ‡æ¢
- [ ] ä¸‰ç§æ ¼å¼éƒ½èƒ½æ­£å¸¸å¯¼å‡º
- [ ] é…ç½®æŒä¹…åŒ–ï¼ˆlocalStorageï¼‰
- [ ] é”™è¯¯å¤„ç†

---

### Phase 5: ä¼˜åŒ–å’Œå®Œå–„ï¼ˆç¬¬11-14å¤©ï¼‰

#### 5.1 æ€§èƒ½ä¼˜åŒ–
- [ ] PDFç”Ÿæˆè¿›åº¦æç¤º
- [ ] é•¿å›¾ç”Ÿæˆè¿›åº¦æç¤º
- [ ] å¤§æ–‡ä»¶å¯¼å‡ºä¼˜åŒ–ï¼ˆåˆ†æ‰¹å¤„ç†ï¼‰
- [ ] å†…å­˜ç®¡ç†ï¼ˆåŠæ—¶æ¸…ç†ï¼‰

#### 5.2 æ ·å¼ä¼˜åŒ–
- [ ] PDFæ ·å¼ç²¾ç»†è°ƒæ•´
- [ ] ä»£ç é«˜äº®ä¼˜åŒ–
- [ ] é•¿å›¾æ°”æ³¡æ ·å¼ç¾åŒ–
- [ ] å“åº”å¼å¸ƒå±€è°ƒæ•´

#### 5.3 åŠŸèƒ½å¢å¼º
- [ ] PDFæ·»åŠ ä¹¦ç­¾ï¼ˆé•¿æ–‡æ¡£ï¼‰
- [ ] é•¿å›¾æ”¯æŒå¤šç§é…è‰²æ–¹æ¡ˆ
- [ ] å¯¼å‡ºé¢„è§ˆåŠŸèƒ½
- [ ] å¯¼å‡ºå†å²è®°å½•

#### 5.4 é”™è¯¯å¤„ç†
- [ ] ç½‘ç»œé”™è¯¯æç¤º
- [ ] æ–‡ä»¶è¿‡å¤§è­¦å‘Š
- [ ] æµè§ˆå™¨å…¼å®¹æ€§æ£€æµ‹
- [ ] é™çº§æ–¹æ¡ˆ

#### 5.5 æ–‡æ¡£å’Œæµ‹è¯•
- [ ] ç¼–å†™ç”¨æˆ·æ–‡æ¡£
- [ ] æ·»åŠ ç¤ºä¾‹æˆªå›¾
- [ ] å•å…ƒæµ‹è¯•
- [ ] é›†æˆæµ‹è¯•
- [ ] æ€§èƒ½æµ‹è¯•

---

## ğŸ“ æ–‡ä»¶ç»“æ„

### æœ€ç»ˆæ–‡ä»¶æ ‘
```
src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ExportPanel.js                # âœï¸ ä¿®æ”¹ï¼šæ·»åŠ æ ¼å¼é€‰æ‹©å’Œä¸“å±é€‰é¡¹
â”‚   â”œâ”€â”€ pdf/                          # ğŸ†• æ–°å¢ï¼šPDFç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ PDFDocument.js            #     - PDFæ–‡æ¡£æ ¹ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ PDFMessage.js             #     - å•æ¡æ¶ˆæ¯ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ PDFCodeBlock.js           #     - ä»£ç å—ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ PDFThinking.js            #     - æ€è€ƒè¿‡ç¨‹ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ PDFArtifact.js            #     - Artifactç»„ä»¶
â”‚   â”‚   â””â”€â”€ PDFStyles.js              #     - PDFæ ·å¼å®šä¹‰
â”‚   â””â”€â”€ image/                        # ğŸ†• æ–°å¢ï¼šé•¿å›¾ç»„ä»¶
â”‚       â”œâ”€â”€ ChatBubbleContainer.js    #     - æ°”æ³¡å®¹å™¨ç»„ä»¶
â”‚       â”œâ”€â”€ ChatBubble.js             #     - å•ä¸ªæ°”æ³¡ç»„ä»¶
â”‚       â””â”€â”€ ChatBubbleStyles.js       #     - æ°”æ³¡æ ·å¼é…ç½®
â”‚
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ exportManager.js              # âœï¸ ä¿®æ”¹ï¼šæ·»åŠ æ ¼å¼è·¯ç”±
â”‚   â”œâ”€â”€ pdfExportManager.js           # ğŸ†• æ–°å¢ï¼šPDFå¯¼å‡ºç®¡ç†å™¨
â”‚   â”œâ”€â”€ imageExportManager.js         # ğŸ†• æ–°å¢ï¼šé•¿å›¾å¯¼å‡ºç®¡ç†å™¨
â”‚   â””â”€â”€ formatHelpers.js              # âœï¸ æ‰©å±•ï¼šæ·»åŠ PDF/å›¾ç‰‡æ ¼å¼åŒ–
â”‚
â”œâ”€â”€ styles/
â”‚   â”œâ”€â”€ export.css                    # âœï¸ ä¿®æ”¹ï¼šæ·»åŠ æ ¼å¼é€‰æ‹©æ ·å¼
â”‚   â””â”€â”€ chat-bubble.css               # ğŸ†• æ–°å¢ï¼šæ°”æ³¡æ ·å¼
â”‚
â”œâ”€â”€ locales/
â”‚   â”œâ”€â”€ zh.json                       # âœï¸ ä¿®æ”¹ï¼šæ·»åŠ å›½é™…åŒ–æ–‡æœ¬
â”‚   â”œâ”€â”€ en.json                       # âœï¸ ä¿®æ”¹
â”‚   â””â”€â”€ ...                           # âœï¸ å…¶ä»–è¯­è¨€
â”‚
â””â”€â”€ App.js                            # âœï¸ ä¿®æ”¹ï¼šæ›´æ–°å¯¼å‡ºé€»è¾‘

package.json                          # âœï¸ ä¿®æ”¹ï¼šæ·»åŠ æ–°ä¾èµ–
```

### ä»£ç è¡Œæ•°ä¼°ç®—
```
æ–°å¢ä»£ç ï¼š
- PDFç»„ä»¶ï¼š~500 è¡Œ
- é•¿å›¾ç»„ä»¶ï¼š~300 è¡Œ
- PDFå¯¼å‡ºç®¡ç†å™¨ï¼š~200 è¡Œ
- é•¿å›¾å¯¼å‡ºç®¡ç†å™¨ï¼š~150 è¡Œ
- ExportPanelæ”¹é€ ï¼š~200 è¡Œ
- æ ·å¼æ–‡ä»¶ï¼š~300 è¡Œ
- å›½é™…åŒ–ï¼š~100 è¡Œ

æ€»è®¡ï¼šçº¦ 1,750 è¡Œæ–°ä»£ç 
```

---

## ğŸ¯ éªŒæ”¶æ ‡å‡†

### PDFå¯¼å‡º
- [x] âœ… å†…å®¹å®Œæ•´ï¼Œé•¿ä»£ç è‡ªåŠ¨æ¢è¡Œ
- [x] âœ… åˆ†é¡µåˆç†ï¼Œä¸åœ¨æ¶ˆæ¯ä¸­é—´æ–­å¼€
- [x] âœ… é€šç”¨PDFæ ¼å¼ï¼Œæ–‡æœ¬å¯é€‰æ‹©
- [x] âœ… æ”¯æŒé¡µçœ‰ã€é¡µè„šã€é¡µç 
- [x] âœ… ä»£ç é«˜äº®æ¸…æ™°
- [x] âœ… æ–‡ä»¶å¤§å°åˆç†ï¼ˆ<10MB/100æ¡æ¶ˆæ¯ï¼‰

### é•¿å›¾å¯¼å‡º
- [x] âœ… ç«–å‘é•¿å›¾ï¼Œé«˜åº¦è‡ªé€‚åº”
- [x] âœ… å¯¹è¯æ°”æ³¡æ ·å¼ç¾è§‚
- [x] âœ… ç”¨æˆ·/åŠ©æ‰‹æ¶ˆæ¯åŒºåˆ†æ˜æ˜¾
- [x] âœ… å¤´åƒã€æ—¶é—´æˆ³æ˜¾ç¤º
- [x] âœ… å›¾ç‰‡æ¸…æ™°ï¼ˆ2å€åˆ†è¾¨ç‡ï¼‰
- [x] âœ… é€‚åˆç§»åŠ¨ç«¯æŸ¥çœ‹ï¼ˆå®½åº¦750pxï¼‰

### UIäº¤äº’
- [x] âœ… æ ¼å¼åˆ‡æ¢æµç•…
- [x] âœ… ä¸“å±é€‰é¡¹æ­£ç¡®æ˜¾ç¤º/éšè—
- [x] âœ… é…ç½®æŒä¹…åŒ–
- [x] âœ… å¯¼å‡ºè¿›åº¦æç¤º
- [x] âœ… é”™è¯¯æç¤ºå‹å¥½

---

## ğŸ“ æ³¨æ„äº‹é¡¹

### PDFå¯¼å‡º
1. **å­—ä½“é—®é¢˜**ï¼š@react-pdf/renderer é»˜è®¤ä½¿ç”¨ Helveticaï¼Œä¸­æ–‡éœ€è¦åµŒå…¥è‡ªå®šä¹‰å­—ä½“
   ```javascript
   import { Font } from '@react-pdf/renderer';
   Font.register({
     family: 'Noto Sans SC',
     src: 'https://fonts.gstatic.com/...'
   });
   ```

2. **åˆ†é¡µæ§åˆ¶**ï¼šä½¿ç”¨ `wrap={false}` é˜²æ­¢å…ƒç´ è·¨é¡µ
3. **ä»£ç é«˜äº®**ï¼šå¯èƒ½éœ€è¦è‡ªå·±å®ç°ç®€å•çš„è¯­æ³•é«˜äº®ï¼ˆreact-pdfä¸ç›´æ¥æ”¯æŒï¼‰
4. **æ–‡ä»¶å¤§å°**ï¼šæ³¨æ„å›¾ç‰‡å‹ç¼©ï¼Œé¿å…PDFè¿‡å¤§

### é•¿å›¾å¯¼å‡º
1. **é«˜åº¦é™åˆ¶**ï¼šæŸäº›æµè§ˆå™¨canvasé«˜åº¦æœ‰é™åˆ¶ï¼ˆ~32767pxï¼‰ï¼Œéœ€è¦åˆ†æ®µå¤„ç†
2. **æ¸²æŸ“æ€§èƒ½**ï¼šè¶…é•¿å¯¹è¯å¯èƒ½å¯¼è‡´æ¸²æŸ“ç¼“æ…¢ï¼Œéœ€è¦è¿›åº¦æç¤º
3. **å­—ä½“åŠ è½½**ï¼šç¡®ä¿è‡ªå®šä¹‰å­—ä½“åŠ è½½å®Œæˆå†æˆªå›¾
4. **è·¨åŸŸå›¾ç‰‡**ï¼šå¦‚æœæ¶ˆæ¯ä¸­æœ‰å¤–éƒ¨å›¾ç‰‡ï¼Œéœ€è¦å¤„ç†CORS

### å…¼å®¹æ€§
- PDFå¯¼å‡ºï¼šChrome 60+, Firefox 55+, Safari 11+
- é•¿å›¾å¯¼å‡ºï¼šChrome 60+, Firefox 55+, Safari 11+
- ç§»åŠ¨ç«¯ï¼šå»ºè®®åœ¨æ¡Œé¢ç«¯å¯¼å‡ºï¼Œç§»åŠ¨ç«¯å¯èƒ½æœ‰æ€§èƒ½é—®é¢˜

---

## ğŸš€ åç»­æ‰©å±•

### å¯é€‰åŠŸèƒ½ï¼ˆç¬¬äºŒæœŸï¼‰
1. **PDFæ¨¡æ¿**ï¼šæä¾›å¤šç§PDFæ¨¡æ¿é£æ ¼
2. **å›¾ç‰‡æ‹¼å›¾**ï¼šè¶…é•¿å¯¹è¯è‡ªåŠ¨æ‹¼æ¥å¤šå¼ å›¾ç‰‡
3. **Wordå¯¼å‡º**ï¼šä½¿ç”¨docxåº“å¯¼å‡ºWordæ–‡æ¡£
4. **PPTå¯¼å‡º**ï¼šä½¿ç”¨pptxgenjså¯¼å‡ºæ¼”ç¤ºæ–‡ç¨¿
5. **å¯¼å‡ºé¢„è§ˆ**ï¼šå¯¼å‡ºå‰é¢„è§ˆæ•ˆæœ
6. **æ‰¹é‡å¯¼å‡º**ï¼šæ”¯æŒæ‰¹é‡å¯¼å‡ºPDF/å›¾ç‰‡

### æ€§èƒ½ä¼˜åŒ–ï¼ˆç¬¬ä¸‰æœŸï¼‰
1. **Web Worker**ï¼šä½¿ç”¨Workerå¤„ç†å¯¼å‡ºï¼Œä¸é˜»å¡UI
2. **è™šæ‹Ÿæ»šåŠ¨**ï¼šé•¿å¯¹è¯ä¼˜åŒ–æ¸²æŸ“
3. **å¢é‡å¯¼å‡º**ï¼šåªå¯¼å‡ºæ–°å¢å†…å®¹
4. **äº‘ç«¯å¯¼å‡º**ï¼šæœåŠ¡å™¨ç«¯ç”ŸæˆPDF

---

## ğŸ“Š æ—¶é—´é¢„ä¼°

| é˜¶æ®µ | å·¥ä½œé‡ | æ—¶é—´ |
|------|--------|------|
| Phase 1: åŸºç¡€æ¶æ„ | å‰ç«¯å¼€å‘ | 2å¤© |
| Phase 2: PDFå¯¼å‡º | å‰ç«¯å¼€å‘ + æµ‹è¯• | 3å¤© |
| Phase 3: é•¿å›¾å¯¼å‡º | å‰ç«¯å¼€å‘ + æµ‹è¯• | 3å¤© |
| Phase 4: é›†æˆ | å‰ç«¯å¼€å‘ + æµ‹è¯• | 2å¤© |
| Phase 5: ä¼˜åŒ–å®Œå–„ | ä¼˜åŒ– + æ–‡æ¡£ | 4å¤© |
| **æ€»è®¡** | | **14å¤©** |

---

## âœ… æ€»ç»“

æœ¬æ–¹æ¡ˆæä¾›äº†å®Œæ•´çš„PDFå’Œé•¿å›¾å¯¼å‡ºåŠŸèƒ½è®¾è®¡ï¼ŒåŒ…æ‹¬ï¼š

1. **æ¸…æ™°çš„æŠ€æœ¯é€‰å‹**ï¼šé€‰æ‹©æœ€é€‚åˆçš„åº“å’Œæ–¹æ¡ˆ
2. **è¯¦ç»†çš„å®ç°è®¡åˆ’**ï¼šåˆ†é˜¶æ®µå®æ–½ï¼Œé™ä½é£é™©
3. **å®Œæ•´çš„ä»£ç ç¤ºä¾‹**ï¼šå¯ç›´æ¥å‚è€ƒå®ç°
4. **å…¨é¢çš„æµ‹è¯•æ¸…å•**ï¼šç¡®ä¿è´¨é‡
5. **åˆç†çš„æ‰©å±•è§„åˆ’**ï¼šä¸ºæœªæ¥é¢„ç•™ç©ºé—´

é€šè¿‡è¿™å¥—æ–¹æ¡ˆï¼Œå¯ä»¥åœ¨2å‘¨å†…å®Œæˆé«˜è´¨é‡çš„PDFå’Œé•¿å›¾å¯¼å‡ºåŠŸèƒ½ï¼Œæå¤§æå‡ç”¨æˆ·ä½“éªŒå’Œäº§å“ç«äº‰åŠ›ï¼
